(()=>{"use strict";class e{constructor(e){this.name=e,this.tasks=[]}addTask(e){this.tasks.push(e)}removeTask(e){this.tasks=this.tasks.filter((t=>t.name!==e))}getTasks(){return this.tasks}}class t{constructor(e,t,n,s){this.name=e,this.description=t,this.dueDate=n,this.priority=s}}const n=[],s=document.getElementById("add-project"),r=document.getElementById("new-task"),c=document.getElementById("create-task"),o=document.getElementById("create-project"),a=document.getElementById("projects"),d=document.querySelector(".list-container ol"),i=document.getElementById("details"),l=document.getElementById("task-editor"),u=document.getElementById("project-editor"),m=document.querySelector(".close-task-modal"),p=document.querySelector(".close-project-modal"),v=document.getElementById("tasks"),h=document.querySelector("#sidebar li");function k(e){return e.replace(/([A-Z])/," $1").replace(/^./,(e=>e.toUpperCase()))}function g(){const e=document.querySelector(".selected")?.getAttribute("project-id");a.innerHTML="",n.forEach(((t,s)=>{const r=function(e,t){const s=document.createElement("div"),r=document.createElement("span");document.getElementsByName("project")[0],s.classList.add("project-wrapper"),r.innerText="-",r.setAttribute("id","remove-project"),r.addEventListener("click",(()=>{!function(e){n.splice(e,1),d.innerHTML="",g(),L()}(t)}));const c=document.createElement("li");return c.innerText=e.name,c.setAttribute("project-id",t),c.addEventListener("click",(t=>{const n=document.querySelector(".selected");n&&n.classList.remove("selected"),t.currentTarget.classList.add("selected"),w(e)})),s.appendChild(c),s.appendChild(r),s}(t,s);a.appendChild(r),s.toString()===e&&r.classList.add("selected")}))}function E(e,t){const n=document.createElement("h2"),s=document.createElement("button"),r=document.querySelector(".details-inner");s.innerText="Ã—",s.classList.add("close-modal"),r.innerHTML="",n.innerText=`${t.name}`,r.appendChild(s),r.appendChild(n),s.addEventListener("click",(()=>{i.classList.remove("open")}));const c=document.createElement("p");c.setAttribute("id",`${e}`),c.innerHTML=`<strong>Project: </strong> ${e}`,r.appendChild(c);const o=Object.entries(t);for(let e=1;e<o.length;e++){const[t,n]=o[e],s=k(t),c=k(n),a=document.createElement("p");a.setAttribute("id",`${s}`),a.innerHTML=`<strong>${s}: </strong> ${c}`,r.appendChild(a)}}function w(e){d.innerHTML="",e.getTasks().forEach((t=>{const n=document.createElement("li");n.innerText=t.name;const s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("class","w-6 h-6 text-gray-800 remove-task dark:text-white"),s.setAttribute("aria-hidden","true"),s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttribute("fill","none"),s.setAttribute("viewBox","0 0 24 24");const r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("stroke","currentColor"),r.setAttribute("stroke-linecap","round"),r.setAttribute("stroke-linejoin","round"),r.setAttribute("stroke-width","2"),r.setAttribute("d","M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"),s.appendChild(r),n.appendChild(s),n.querySelector(".remove-task").addEventListener("click",(s=>{s.stopPropagation(),e.removeTask(t.name),n.remove(),L()})),n.addEventListener("click",(()=>{E(e.name,t),i.classList.add("open")})),d.appendChild(n)}))}function L(){const e=localStorage.getItem("projectKey");let t;t=e?JSON.parse(e):{projects:[]},t.projects=n.map((e=>({name:e.name,tasks:e.tasks}))),localStorage.setItem("projectKey",JSON.stringify(t))}m.addEventListener("click",(e=>{e.preventDefault(),l.classList.remove("open")})),p.addEventListener("click",(e=>{e.preventDefault(),u.classList.remove("open")})),s.addEventListener("click",(()=>{u.classList.add("open")})),r.addEventListener("click",(()=>{l.classList.add("open")})),c.addEventListener("click",(e=>{!function(){const e=document.getElementById("task-name").value,s=document.getElementById("task-desc").value,r=document.getElementById("due-date").value,c=document.querySelector("input[name='priority']:checked").value,o=document.querySelector(".selected"),a=document.getElementsByName("task")[0];if(!o)return console.log("Abasho"),void alert("Please select a project first before adding tasks.");const d=n[o.getAttribute("project-id")],i=new t(e,s,r,c);d.addTask(i),w(d),L(),a.reset()}(),e.preventDefault(),l.classList.remove("open")})),o.addEventListener("click",(t=>{!function(){const t=document.querySelector("#project-name").value,s=new e(t);n.push(s),L(),g()}(),t.preventDefault(),u.classList.remove("open")})),h.addEventListener("click",(e=>{const t=document.querySelector(".selected");t&&t.classList.remove("selected"),e.currentTarget.classList.add("selected")})),v.addEventListener("click",(()=>{d.innerHTML="",n.forEach((e=>{e.getTasks().forEach((t=>{const n=document.createElement("li");n.innerText=t.name;const s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("class","w-6 h-6 text-gray-800 remove-task dark:text-white"),s.setAttribute("aria-hidden","true"),s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttribute("fill","none"),s.setAttribute("viewBox","0 0 24 24");const r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("stroke","currentColor"),r.setAttribute("stroke-linecap","round"),r.setAttribute("stroke-linejoin","round"),r.setAttribute("stroke-width","2"),r.setAttribute("d","M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"),s.appendChild(r),n.appendChild(s),n.querySelector(".remove-task").addEventListener("click",(s=>{s.stopPropagation(),e.removeTask(t.name),n.remove()})),n.addEventListener("click",(()=>{E(e.name,t),i.classList.add("open")})),d.appendChild(n)}))}))})),window.addEventListener("load",(()=>{!function(){const s=localStorage.getItem("projectKey");if(s){const r=JSON.parse(s);n.splice(0),r.projects.forEach((s=>{const r=new e(s.name);s.tasks.forEach((e=>{const n=new t(e.name,e.description,e.dueDate,e.priority);r.addTask(n)})),n.push(r)}))}}(),g()}))})();